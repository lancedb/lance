name: Bump version using bump-my-version
description: "Automated version bumping using bump-my-version tool"
inputs:
  bump_type:
    description: "Type of version bump (major, minor, patch)"
    required: true
    default: "patch"
  dry_run:
    description: "Perform a dry run without making changes"
    required: false
    default: "false"
runs:
  using: "composite"
  steps:
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    
    - name: Install dependencies
      shell: bash
      run: |
        pip install bump-my-version
    
    - name: Set git configs
      shell: bash
      run: |
        git config user.name 'Lance Release Bot'
        git config user.email 'lance-dev@lancedb.com'
    
    - name: Run version bump
      shell: bash
      run: |
        if [ "${{ inputs.dry_run }}" == "true" ]; then
          python ci/bump_version.py ${{ inputs.bump_type }} --dry-run
        else
          python ci/bump_version.py ${{ inputs.bump_type }}
        fi
    
    - name: Show changes
      shell: bash
      run: |
        echo "## Version changes:"
        git diff --name-only
        echo ""
        echo "## Detailed changes:"
        git diff --stat